{% extends 'layouts/base.html' %}

{% block content %}
<div class="ui stackable grid container">
    <div class="sixteen wide column">
        <h1 class="ui header">Usage Log Details</h1>
        <div class="ui divider"></div>
        
        <div class="ui segments">
            <div class="ui blue segment">
                <h3 class="ui header">Basic Information</h3>
            </div>
            <div class="ui segment">
                <div class="ui list">
                    <div class="item">
                        <div class="header">Resident</div>
                        {{ log.resident.name }}
                    </div>
                    <div class="item">
                        <div class="header">Medication/Supply</div>
                        {{ log.inventory_item.name }} ({{ log.inventory_item.type }})
                    </div>
                    <div class="item">
                        <div class="header">Status</div>
                        <div class="ui {% if log.status.name == 'TAKEN' %}green{% else %}red{% endif %} label">
                            {{ log.status.value }}
                        </div>
                    </div>
                    <div class="item">
                        <div class="header">Timestamp</div>
                        {{ log.timestamp.strftime('%Y-%m-%d %H:%M:%S') }}
                    </div>
                    {% if log.scheduled_time %}
                        <div class="item">
                            <div class="header">Scheduled Time</div>
                            {{ log.scheduled_time }}
                        </div>
                    {% endif %}
                    <div class="item">
                        <div class="header">Caregiver</div>
                        {{ log.caregiver.full_name() }}
                    </div>
                </div>
            </div>
            
            {% if log.notes %}
                <div class="ui blue segment">
                    <h3 class="ui header">Notes</h3>
                </div>
                <div class="ui segment">
                    <p>{{ log.notes }}</p>
                </div>
            {% endif %}
            
            {% if log.voice_note_url %}
                <div class="ui blue segment">
                    <h3 class="ui header">Voice Note</h3>
                </div>
                <div class="ui segment">
                    <audio controls>
                        <source src="{{ log.voice_note_url }}" type="audio/mpeg">
                        Your browser does not support the audio element.
                    </audio>
                </div>
            {% endif %}
        </div>
        
        <div class="ui buttons">
            <a class="ui basic button" href="{{ url_for('usage.index', resident_id=log.resident_id) }}">
                <i class="caret left icon"></i>
                Back to Usage Logs
            </a>
            <a class="ui negative button" href="{{ url_for('usage.delete_log', log_id=log.id) }}"
               onclick="return confirm('Are you sure you want to delete this log?');">
                <i class="trash icon"></i>
                Delete Log
            </a>
        </div>
    </div>
</div>
{% endblock %}
